<!DOCTYPE html> 
<html>
<head>
	<title>Devops Trouble Map</title>
	<meta charset="utf-8"/>
	<link rel='stylesheet' type='text/css' href='css/default.css'/>
</head>
<body>
	<script type="text/javascript" src="jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="jquery.timeago.js"></script>
	<script type="text/javascript" src="dotm_common.js"></script>
	<script type="text/javascript" src="dotm_view_node.js"></script>
	<script type="text/javascript" src="dotm_view_all_nodes.js"></script>
	<script src="d3.v3.js"></script>
	<script src="cola.v3.min.js"></script>

	<h1 class='title'>Devops Trouble Map</h1>

	<div class='statusBox'>
	<div class='status'></div>
	</div>

	<div class='blockrow1'>
	<div class='block'>
		<div class='blockTitle'><a href=''>Nodes</a></div>
		<div class='nodes'></div>
	</div>

	<!-- Chart representation -->

	<div class='nodeChart'>
	</div>
	</div>

	<!-- Table representation -->
	<div id='nodeTables'>
		<div class='block'>
			<div class='blockTitle'>Services</div>
			<table class='services'></table>
		</div>

		<div class='block'>
			<div class='blockTitle'>Connections</div>
			<table class='connections'></table>
		</div>
	</div>

	<!--<div class='block'>
		<div class='blockTitle'>Alerts</div>
		<div class='alerts'>IMPLEMENT ME!</div>
	</div>-->

	<script>
		(function() {
		jQuery.timeago.settings.strings.suffixAgo = null;

		// Fetch nodes
		setStatus('Fetching nodes...');
		$.getJSON("backend/nodes", {})
		.done(function (data) {
			var nodes = [];
			$.each(data.nodes, function (index, node) {
				nodes.push('<a href="javascript:loadNode(\''+node+'\')">'+node+'</a>');
			})
			$(".nodes").html(nodes.join("<br/>"));
			setStatus('Please select a node.');
			loadNodesGraph(data.nodes, data.connections);
		})
		.fail(function (jqxhr, textStatus, error) {
			setError('Node list fetch failed! ('+error+')');
		})
		})();
	</script>
</body>
</html>
