<!DOCTYPE html> 
<html>
<head>
	<title>DevOps Trouble Map</title>
	<meta charset="utf-8"/>
	<link rel='stylesheet' type='text/css' href='css/default.css'/>
</head>
<body>
	<script type="text/javascript" src="jquery-2.1.1.min.js"></script>
	<script type="text/javascript" src="jquery.timeago.js"></script>
	<script type="text/javascript" src="dotm_common.js"></script>
	<script type="text/javascript" src="dotm_view_node.js"></script>
	<script type="text/javascript" src="dotm_view_all_nodes.js"></script>
	<script type="text/javascript" src="dotm_view_config.js"></script>
	<script src="d3.v3.js"></script>
	<script src="cola.v3.min.js"></script>

	<table class='header title'>
	<tr>
		<td class='title'>
			<h1 class='title'>Devops Trouble Map</h1>
		</td>
		<td class='menu'>
			<a href="javascript:loadConfig()">Settings</a>
		</td>
	</tr>
	</table>

	<div id='leftsidebar'>
		<!-- FIXME move this into all nodes view -->
		<div class='blockTitle'><a href=''>Nodes</a></div>
		<div id='nodeList'></div>
	</div>

	<div class='statusBox'>
		<div class='status'></div>
	</div>

	<div id='stage'></div>

	<script>
		(function() {
		jQuery.timeago.settings.strings.suffixAgo = null;

		// Fetch nodes
		setStatus('Fetching nodes...');
		$.getJSON("backend/nodes", {})
		.done(function (data) {
			var nodes = [];
			$.each(data.nodes, function (index, node) {
				nodes.push('<a href="javascript:loadNode(\''+node+'\')">'+node+'</a>');
			})
			$("#nodeList").html(nodes.join("<br/>"));
			setStatus('Please select a node.');
			loadNodesGraph(data.nodes, data.connections);
		})
		.fail(function (jqxhr, textStatus, error) {
			setError('Node list fetch failed! ('+error+')');
		})
		})();
	</script>
</body>
</html>
